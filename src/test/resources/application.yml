logging:
  level:
    org.springframework: WARN

config:
  global-environment:
    - GLOBAL=green bar

schedule:

  - every: 1 minutes
    task: hello
    name: testEveryMinute

  - every: hour
    task: hello
    name: testEveryHour

  - every: 1 day
    task: hello
    name: testEveryDay
    
  - every: month
    task: hello
    name: testEveryMonth

  # Run two times, at 11 and 16
  - cron: 00 00 11,16 * * *
    task: hello

notify:
  email:
    - name: notifyEmailTest
      task: helloNotifyEmail
      when: always

      server: localhost
      port: 3025
      username: test@server.local
      password: test
      protocol: smtp
      starttls: true
      debug: true
      validate-server-on-configuration-load: false

      subject: Email subject
      sender: myemail@gmail.com
      recipients: admin@server.local
      content: Task finished  
      
    - name: notifyEmailTestMultipleRecipients
      task: helloNotifyEmailMultipleRecipients
      when: always

      server: localhost
      port: 3025
      username: test@server.local
      password: test
      protocol: smtp
      starttls: true
      debug: true
      validate-server-on-configuration-load: false

      subject: Email subject
      sender: myemail@gmail.com
      recipients:
        - admin@server.local
        - admin2@server.local
      content: Task finished    

    - name: notifyEmailTestMultilineContent
      task: helloNotifyEmailMultilineContent
      when: always
      validate-server-on-configuration-load: false

      server: localhost
      port: 3025
      username: test@server.local
      password: test
      protocol: smtp
      starttls: true
      debug: true

      subject: Email subject
      sender: myemail@gmail.com
      recipients:
        - admin@server.local
        - admin2@server.local
      content: |
        Multiline
        Task finished
    - name: notifyEmailWithoutSender
      task: helloNotifyEmailWithoutSender
      when: always
      validate-server-on-configuration-load: false

      server: localhost
      port: 3025
      username: test@server.local
      password: test
      protocol: smtp
      starttls: true
      debug: true

      subject: Email subject
      recipients:
        - admin@server.local
        - admin2@server.local
      content: |
        Multiline
        Task finished
    - name: notifyEmailServerConnectionProblem
      task: helloNotifyEmailServerConnectionProblem
      when: always
      validate-server-on-configuration-load: false

      server: thishostwillneverexist
      port: 3025
      username: test@server.local
      password: test
      protocol: smtp
      starttls: true
      debug: true

      subject: Email subject
      recipients:
        - admin@server.local
        - admin2@server.local
      content: |
        Multiline
        Task finished
    - name: notifyEmailServerAuthProblem
      task: helloNotifyEmailServerAuthProblem
      when: always
      validate-server-on-configuration-load: false

      server: thishostwillneverexist
      port: 3025
      username: invalid@server.local
      password: invalid
      protocol: smtp
      starttls: true
      debug: true

      subject: Email subject
      recipients:
        - admin@server.local
        - admin2@server.local
      content: |
        Multiline
        Task finished
tasks:
  docker:
    - name: hello
      image: debian:jessie
      entrypoint: /bin/sh
      arguments:
        - -c
        - echo green bar
        
    - name: helloScript
      image: debian:jessie
      script:
        - echo green bar
        - echo green barbar
        
    - name: helloScriptPipe
      image: debian:jessie
      script:
        - echo green bar
        - echo wrong | grep -v wrong
        - echo green barbar
        
    - name: helloScriptStrict
      image: debian:jessie
      script-strict: true
      script:
        - echo green bar
        - echo red bar | grep -q green
        - echo greener bar
        
    - name: helloEnvironmentVariables
      image: debian:jessie
      script:
        - echo $BAR
      environment:
        - BAR=green bar 
        
    - name: helloEnvironmentVariablesGlobal
      image: debian:jessie
      script:
        - echo $GLOBAL
        
    - name: helloEnvironmentVariablesGlobalOverride
      image: debian:jessie
      script:
        - echo $GLOBAL
      environment:
        - GLOBAL=green is the bar
        
    - name: helloWithVolume01
      image: debian:jessie
      script:
        - echo $expected > /mappedVolume/file
      volumes:
        - testVolume:/mappedVolume

    - name: helloWithVolume02
      image: debian:jessie
      script:
        - cat /mappedVolume/file
      volumes:
        - testVolume:/mappedVolume 

    - name: helloAlwaysPull
      image: debian:jessie
      always-pull: true
      script:
        - echo green bar
        
    - name: helloWithNetwork01
      image: debian:jessie
      script:
        - ping -c 4 helloWithNetwork02 >/dev/null && echo green bar
      network: testNetwork

    - name: helloWithNetwork02
      image: debian:jessie
      script:
        - sleep 30
        - echo green bar
      network: testNetwork
      
    - name: helloReuseContainer
      image: debian:jessie
      reuse-container: true
      script:
        - if [ -f test ]; then echo green bar; fi
        - touch test

    - name: helloRemoveExistingContainer
      image: debian:jessie
      keep-container-after-execution: true
      script:
        - if [ -f test ]; then echo red bar; fi
        - echo green bar
        - touch test
        
    - name: helloNotify
      image: debian:jessie
      script:
        - echo green bar

    - name: helloNotifyAlways
      image: debian:jessie
      script:
        - echo green bar
        
    - name: helloNotifyAlwaysError
      image: debian:jessie
      script:
        - echo green bar     
        - cat /invalidFile  

    - name: helloNotifyOnError
      image: debian:jessie
      script:
        - echo green bar
        
    - name: helloNotifyOnErrorError
      image: debian:jessie
      script:
        - echo green bar     
        - cat /invalidFile  
        
    - name: helloNotifyOnSuccess
      image: debian:jessie
      script:
        - echo green bar
        
    - name: helloNotifyOnSuccessError
      image: debian:jessie
      script:
        - echo green bar     
        - cat /invalidFile  
        
    - name: helloNotifyEmail
      image: debian:jessie
      script:
        - echo green bar   

    - name: helloNotifyEmailMultipleRecipients
      image: debian:jessie
      script:
        - echo green bar   
    
    - name: helloNotifyEmailMultilineContent
      image: debian:jessie
      script:
        - echo green bar        
    
    - name: helloNotifyEmailWithoutSender
      image: debian:jessie
      script:
        - echo green bar        

    - name: helloNotifyEmailServerConnectionProblem
      image: debian:jessie
      script:
        - echo green bar        

    - name: helloNotifyEmailServerAuthProblem
      image: debian:jessie
      script:
        - echo green bar        
     
